"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[439],{4439:function(e,t,i){i.d(t,{m:function(){return w}});var a=i(9099);i(4590);var n=i(8064);(0,n.$)("91da53cd065ce9be8d80944eae1a41570833fbe5");var s=(0,n.$)("b1760b48b6736c3ceb39a5bbf2e31ba9ccc99e82"),r=(0,n.$)("0f1294bc9e4111785efb7715c6e53a7bcbff96ae"),o=(0,n.$)("3aec30fd6169ee079eaf3c4f5c205c692c5c2675"),c=(0,n.$)("7321d291e684b575f4ee5389254a04056c9edee8");(0,n.$)("4dd3fa7cbece892d71ff4ae4d756ca88b4034606");var l=(0,n.$)("a1f89364245ffc75262644f01b52daefc1516aae"),d=(0,n.$)("bc2ccbd100cc9cb45649b29308c370c90ebea8cc"),u=(0,n.$)("543b4831f8c8e097a0bd67cf68353ecc98184d18"),f=(0,n.$)("36f3b6e87e3b3cc95b94a90034a43020b6a6c17d"),g=(0,n.$)("72b0b18b5794e390b5eeaa51a57b6819c63cd105"),v=(0,n.$)("7454f043ce310f307304b704be243a840720f5e4"),m=i(4433),b=(0,n.$)("008ee71fc3d4d841b254c9017afa9fe67223c855"),h=(0,n.$)("6bc3721170af6c2f840c5d3853ed459d902de327"),p=(0,n.$)("21cd77a16aede805cdafe8e77b44fa34a7c1ae05");(0,n.$)("4f13edb464afb630b6ce261b50b2c84df845bad9"),(0,n.$)("6186f7ba8d7fac178a0500239c7ffc6006db0037"),(0,n.$)("15a10ff003b19130f4264c496153ae7d002eb7cb"),(0,n.$)("4c407400859f9e3a485c7c4c6a50d7a5f2f55c9e");let w=(0,a.Ue)((e,t)=>({questions:[],questionToEdit:void 0,loading:!0,isAdmin:!1,categories:[],isOrganizer:!1,isAuthenticated:!1,userInfo:null,ipInfo:null,adminViewEnabled:!0,totalCount:0,currentPage:1,itemsPerPage:100,filterOptions:{updatedAfterReview:!1,noReviews:!1,sortByNewReviews:!1,numReviews:void 0,scoreFilter:{score:void 0,type:m.aE.NONE},ranking:{enable:!1,category:"math",model:"gpt-4o-mini",complexity:"2nlogn"}},reviewerFilterOptions:m.ln,organizerReviewSummaryFilter:m.i9,stats:{subjectCounts:{},answerTypeCounts:{multipleChoice:0,exactMatch:0}},reviewerEmails:[],rankingData:null,offlineModelAnswers:{},splitInfo:{},categoryStats:{},validUser:!1,getOfflineModelAnswers:e=>t().offlineModelAnswers[e],setQuestionToEdit:t=>{e({questionToEdit:t||void 0})},fetchQuestionToEdit:async(e,i)=>{var a;let n=((null===(a=t().userInfo)||void 0===a?void 0:a.emails)||[])[0],s=t().isAdmin;try{return await g(e,n,s,i)}catch(e){console.error("Failed to fetch question to edit:",e);return}},fetchQuestions:async function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.yl.Question,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;e({loading:!0});try{var s;let r=(a-1)*n,o=await c((null===(s=t().userInfo)||void 0===s?void 0:s.emails)||[],t().isAdmin&&t().adminViewEnabled,i,t().filterOptions,t().reviewerFilterOptions,n,r),d={};if(t().isOrganizer){let e=o.questions.map(e=>e.id);d=await l(e)}e({questions:o.questions,totalCount:o.totalCount,stats:o.stats,currentPage:a,itemsPerPage:n,rankingData:o.rankingData,offlineModelAnswers:d,splitInfo:o.splitInfo})}catch(e){console.error("Failed to fetch questions:",e)}finally{e({loading:!1})}},searchQuestions:async function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.yl.Question;e({loading:!0});try{var a;let{questions:n,totalCount:s,stats:r,splitInfo:o}=await c((null===(a=t().userInfo)||void 0===a?void 0:a.emails)||[],t().isAdmin&&t().adminViewEnabled,i,t().filterOptions),d={};if(t().isOrganizer){let e=n.map(e=>e.id);d=await l(e)}e({questions:n,totalCount:s,stats:r,currentPage:1,itemsPerPage:t().itemsPerPage,offlineModelAnswers:d,splitInfo:o})}catch(e){console.error("Failed to perform search:",e)}finally{e({loading:!1})}},checkAdminStatus:async()=>{let i=t().userInfo;if(!i){e({isAdmin:!1});return}try{let a=await s(i.emails);if(null!==a){t().checkOrganizerStatus();let i=await r(),n=await o();t().getReviewStats();let s=a.categories,c=i.filter(e=>t().isOrganizer||s.includes(e));e({isAdmin:!0,categories:c,reviewerEmails:n})}else e({isAdmin:!1})}catch(t){console.error("Failed to check admin status:",t),e({isAdmin:!1})}},checkOrganizerStatus:()=>{let i=t().userInfo;if(!i)return e({isOrganizer:!1}),!1;try{let t=["n.l@berkeley.edu"],a=i.emails.some(e=>e.endsWith("@safe.ai")||e.endsWith("@scale.com")||t.includes(e));return e({isOrganizer:a}),a}catch(t){return console.error("Failed to check organizer status:",t),e({isOrganizer:!1}),!1}},updateQuestion:async function(e,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.yl.Question,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{var s;t().ipInfo&&(i={...i,extraInfo:{ipInfo:t().ipInfo||""}}),await u(e,(null===(s=t().userInfo)||void 0===s?void 0:s.emails)||[],i,t().isAdmin,a,n),t().isAuthenticated&&a===m.yl.Question&&t().fetchQuestions(a)}catch(e){console.error("Failed to update ".concat(a,":"),e)}},updatedQuestionByReviewer:async function(e,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.yl.Question,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{var s;await u(e,(null===(s=t().userInfo)||void 0===s?void 0:s.emails)||[],i,t().isAdmin&&t().isOrganizer,a,n,m.z6.REVIEWER_UPDATED),t().isAuthenticated&&t().fetchQuestions(a)}catch(e){console.error("Failed to update ".concat(a,":"),e)}},deleteQuestion:async function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.yl.Question;try{var a;await v(e,(null===(a=t().userInfo)||void 0===a?void 0:a.emails)||[],t().isAdmin&&t().adminViewEnabled&&t().isOrganizer,i),t().fetchQuestions(i)}catch(e){console.error("Failed to delete question:",e)}},createQuestion:async function(e){let i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.yl.Question;try{return t().ipInfo&&(e={...e,extraInfo:{ipInfo:t().ipInfo}}),i=await d(e,a),t().isAuthenticated&&a===m.yl.Question&&t().fetchQuestions(a),i}catch(e){console.error("Failed to create question:",e);return}},updateReviews:async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.yl.Question;try{return await f(e,t,i),{status:200,message:"Reviews updated successfully"}}catch(e){return console.error("Failed to update ".concat(i,":"),e),{status:400,message:e instanceof Error?e.message:"An unknown error occurred"}}},setAuthentication:async(i,a)=>{if(i&&a){e({isAuthenticated:!0,userInfo:a});let i=await p(a.emails);e({validUser:i}),i&&await t().checkAdminStatus(),t().fetchQuestions()}else e({isAuthenticated:!1,userInfo:null,isAdmin:!1,isOrganizer:!1,questions:[],adminViewEnabled:!0})},toggleAdminView:()=>{e(e=>({adminViewEnabled:!e.adminViewEnabled})),t().fetchQuestions()},toggleOrganizerView:()=>{e(e=>({isOrganizer:!e.isOrganizer})),t().fetchQuestions()},initializeIpInfo:async()=>{try{let t=await fetch("https://api.ipify.org?format=json&ipAddress="),{ip:i}=await t.json(),a=await b(i);200===a.status?e({ipInfo:a.data}):i?e({ipInfo:{ip:i}}):e({ipInfo:null})}catch(t){e({ipInfo:null})}},setFilterOptions:t=>{e(e=>({filterOptions:{...e.filterOptions,...t}}))},setScoreFilter:t=>{e(e=>{var i;let a=t.type;return void 0!==t.score&&(null===(i=e.filterOptions.scoreFilter)||void 0===i?void 0:i.type)===m.aE.NONE?a=m.aE.EQ:void 0===t.score&&(a=m.aE.NONE),{filterOptions:{...e.filterOptions,scoreFilter:{...t,type:a}}}})},setReviewerFilterOptions:t=>{e(e=>({reviewerFilterOptions:{...e.reviewerFilterOptions,...t}}))},getReviewStats:async()=>{try{let i=t().organizerReviewSummaryFilter,a=await h(i);e({categoryStats:a})}catch(e){console.error("Failed to fetch review stats:",e)}},setOrganizerReviewSummaryFilter:i=>{e(e=>({organizerReviewSummaryFilter:{...e.organizerReviewSummaryFilter,...i}})),t().getReviewStats()},getSplitType:e=>t().splitInfo[e]||m.p_.NONE}))}}]);